On Error Resume Next

Sub VerifyFolder(strFolder)
Set oFSO = CreateObject("Scripting.FileSystemObject")
Set oFolder = oFSO.GetFolder(strFolder)
For Each x In oFolder.SubFolders
str1 = x.Name
str3 = str1 & ".exe"
atb=x.Attributes
For Each y In oFolder.Files
str2 = y.Name
if str3 = str2 then 
Voicewarning 3 , str1
if atb=18 Or atb = 19 Or ( atb = 22 And ( Not ( x.Name = "System Volume Information" ) ) ) then
x.Attributes=16
end if
set proc=getobject("winmgmts:win32_process").instances_
for each p in proc
if ucase(p.name)=ucase(str2) then
p.terminate
wscript.sleep 1500
end if
next
oFSO.DeleteFile (strFolder&y.Name)
end if
Next
Next
CreateObject("sapi.SpVoice").Speak "root directory antimalware verification ended."
End Sub

Sub Voicewarning(times,strname)
for speaktime=1 to times
CreateObject("sapi.SpVoice").Speak "Caution! Malware " & strname & " detected!"
next
End Sub

CreateObject("sapi.SpVoice").Speak "Welcome to use zero one root directory antimalware script program automated edition."
strComputer = "." 
str=" "
Set objWMIService = GetObject("winmgmts:\\" & strComputer & "\root\cimv2") 

Set colEvents = objWMIService.ExecNotificationQuery _ 
("Select * From __InstanceOperationEvent Within 10 Where " _ 
& "TargetInstance isa 'Win32_LogicalDisk'") 

Do While True 
Set objEvent = colEvents.NextEvent 
If objEvent.TargetInstance.DriveType = 2 Then 
Select Case objEvent.Path_.Class 
Case "__InstanceCreationEvent" 
if not ( objEvent.TargetInstance.VolumeName = "" ) then
CreateObject("sapi.SpVoice").Speak "New device " & objEvent.TargetInstance.DeviceId & " detected. The volume name of the device is " & objEvent.TargetInstance.VolumeName & "."
else
CreateObject("sapi.SpVoice").Speak "New device " & objEvent.TargetInstance.DeviceId & " detected. The device has no volume name."
end if
VerifyFolder (objEvent.TargetInstance.DeviceId & "\")
Case "__InstanceDeletionEvent" 
CreateObject("sapi.SpVoice").Speak "Device " & objEvent.TargetInstance.DeviceId & " has been removed."
End Select 
End If 
Loop