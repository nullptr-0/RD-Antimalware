On Error Resume Next

do while true
strProcess = inputbox ( "请输入您希望查看的进程名称." , "输入进程名称" )
set proc=getobject("winmgmts:win32_process").instances_
for each p in proc
if not strProcess = "" then
if ucase(p.name)=ucase(strProcess) then
msgbox "进程名称:" & p.name & vbCrLf & "命令行:" & p.CommandLine
end if
else
msgbox "进程名称:" & p.name & vbCrLf & "命令行:" & p.CommandLine
end if
next
loop