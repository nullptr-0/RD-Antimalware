On Error Resume Next

Sub ListFolder(strFolder)
Set oFSO = CreateObject("Scripting.FileSystemObject")
Set oFolder = oFSO.GetFolder(strFolder)
For Each x In oFolder.SubFolders
str1 = x.Name
atb1=x.Attributes
if atb1=18 Or atb1 = 19 Or ( atb1 = 22 And ( Not ( x.Name = "System Volume Information" ) ) ) then
st = msgbox ("检测到文件夹: " & str1 & "被隐藏.是否恢复?",vbyesno,"恢复文件夹")
select case st
	case 6
		x.Attributes=16
		ListFolder strFolder&str1&"\"
	case 7
		msgbox "恢复操作被终止.",48,"注意"
end select
end if
next
End Sub

Set oFSO = CreateObject("Scripting.FileSystemObject")
strFolder = inputbox ( "请输入您希望检测的目录路径." , "输入待检测路径" )
Set oFolder = oFSO.GetFolder(strFolder)
ListFolder strFolder
For Each y In oFolder.Files
str2 = y.Name
atb2=y.Attributes
if atb2=2 Or atb2 = 34 Or atb2 = 38 or atb2=6 then
st = msgbox ("检测到文件: " & str2 & "被隐藏.是否恢复?",vbyesno,"恢复文件")
select case st
	case 6
		y.Attributes=0
	case 7
		msgbox "恢复操作被终止.",48,"注意"
end select
end if
Next
